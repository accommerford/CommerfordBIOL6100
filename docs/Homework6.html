<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Audrey Commerford" />

<meta name="date" content="2025-02-19" />

<title>Homework 6</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Homework Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Homework3.html">Homework 3</a>
    </li>
    <li>
      <a href="Homework4.html">Homework 4</a>
    </li>
    <li>
      <a href="Homework5.html">Homework 5</a>
    </li>
    <li>
      <a href="Homework6.5.html">Homework 6</a>
    </li>
    <li>
      <a href="Homework7.html">Homework 7</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Homework 6</h1>
<h4 class="author">Audrey Commerford</h4>
<h4 class="date">2025-02-19</h4>

</div>


<ol style="list-style-type: decimal">
<li>Think about an ongoing study in your lab (or a paper you have read
in a different class), and decide on a pattern that you might expect in
your experiment if a specific hypothesis were true.</li>
</ol>
<p>I was recently reading about fluoridated water as a public health
intervention. I am basing this model vaguely off of <a
href="https://onlinelibrary.wiley.com/doi/full/10.1111/cdoe.12685#cdoe12685-bib-0010">this
study</a> done in Canada following the cessation of community water
fluoridation in certain areas. The authors note that population exposure
to fluoridation has decreased from 43% in 2007 to 39% in 2017. The
expected pattern is that the prevalence of dental caries across a
country will increase as population fluoride exposure decreases.</p>
<ol start="2" style="list-style-type: decimal">
<li>To start simply, assume that the data in each of your treatment
groups follow a normal distribution. Specify the sample sizes, means,
and variances for each group that would be reasonable if your hypothesis
were true. You may need to consult some previous literature and/or an
expert in the field to come up with these numbers.</li>
</ol>
<pre class="r"><code># the explanatory variable is the percentage of population exposed to fluoridated water in a given region
exposure &lt;- rnorm(50, mean=41, sd=10)
hist(exposure)</code></pre>
<p><img src="Homework6_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code># the response variable is the prevalence of dental caries in the population
dental_caries &lt;- rnorm(50, mean=3.1, sd=0.2)
hist(dental_caries)</code></pre>
<p><img src="Homework6_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Using the methods we have covered in class, write code to create a
random data set that has these attributes. Organize these data into a
data frame with the appropriate structure.</li>
</ol>
<pre class="r"><code># creating the data frame
data_frame &lt;- data.frame(exposure, dental_caries)
print(data_frame)</code></pre>
<pre><code>##    exposure dental_caries
## 1  60.07408      3.544500
## 2  26.02729      3.130649
## 3  47.52840      3.043380
## 4  52.98033      3.134166
## 5  21.16541      3.436074
## 6  32.60329      3.074391
## 7  31.32242      3.268032
## 8  24.58581      3.209474
## 9  32.75240      2.783757
## 10 44.17564      2.864605
## 11 46.25686      3.081696
## 12 33.64245      2.994830
## 13 49.31935      3.031155
## 14 44.80267      3.172656
## 15 59.21025      2.784054
## 16 40.42815      3.030403
## 17 43.99393      2.997202
## 18 46.89828      3.217005
## 19 61.59727      3.267501
## 20 36.61401      3.400387
## 21 50.52901      3.038448
## 22 31.81918      3.575265
## 23 42.44499      3.178876
## 24 42.54640      3.385232
## 25 56.32174      3.235255
## 26 43.54799      2.500343
## 27 34.48039      2.989815
## 28 39.43464      3.077727
## 29 38.16524      3.416731
## 30 49.57120      3.083920
## 31 44.76572      3.213164
## 32 40.57136      3.204641
## 33 40.03525      2.569373
## 34 40.02032      3.036292
## 35 30.09822      3.471694
## 36 29.15706      2.960057
## 37 31.04675      3.230655
## 38 31.75717      2.927768
## 39 45.78389      3.069103
## 40 48.06513      3.329676
## 41 26.61510      3.321327
## 42 60.06009      3.138226
## 43 41.45455      2.980815
## 44 49.19574      3.117875
## 45 45.63985      3.359678
## 46 56.23940      2.957083
## 47 53.10758      2.729116
## 48 35.08573      3.130789
## 49 44.81177      2.890501
## 50 34.67115      3.101764</code></pre>
<pre class="r"><code># fitting the variables to a linear model
model &lt;- lm(dental_caries~exposure)</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Now write code to analyze the data (probably as an ANOVA or
regression analysis, but possibly as a logistic regression or
contingency table analysis. Write code to generate a useful graph of the
data.</li>
</ol>
<pre class="r"><code># using anova to test for significance
anova(model)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: dental_caries
##           Df  Sum Sq  Mean Sq F value Pr(&gt;F)
## exposure   1 0.05287 0.052867  1.0445 0.3119
## Residuals 48 2.42958 0.050616</code></pre>
<pre class="r"><code># and qplot to plot the results
library(ggplot2)
qplot(x=exposure, y=dental_caries)</code></pre>
<pre><code>## Warning: `qplot()` was deprecated in
## ggplot2 3.4.0.
## This warning is displayed
## once every 8 hours.
## Call
## `lifecycle::last_lifecycle_warnings()`
## to see where this warning was
## generated.</code></pre>
<p><img src="Homework6_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<ol start="5" style="list-style-type: decimal">
<li><p>Try running your analysis multiple times to get a feeling for how
variable the results are with the same parameters, but different sets of
random numbers.</p></li>
<li><p>Now, using a series of for loops, adjust the parameters of your
data to explore how they might impact your results/analysis, and store
the results of your for loops into an object so you can view it. For
example, what happens if you were to start with a small sample size and
then re-run your analysis? Would you still get a significant result?
What if you were to increase that sample size by 5, or 10? How small can
your sample size be before you detect a significant pattern (p &lt;
0.05)? How small can the differences between the groups be (the “effect
size”) for you to still detect a significant pattern?</p></li>
</ol>
<pre class="r"><code># using a for loop to test different sample sizes
sample_sizes &lt;- seq(10, 100, by = 10)
n_iter &lt;- length(sample_sizes)

# Pre-allocate a data frame
results &lt;- data.frame(SampleSize = sample_sizes,
                      PValue = rep(NA, n_iter),
                      Significant = rep(NA, n_iter))

# Loop over the sample sizes
for (i in seq_along(sample_sizes)) {
  n &lt;- sample_sizes[i]
  
  # Generate random data
  exposure &lt;- rnorm(n, mean = 41, sd = 10)
  dental_caries &lt;- rnorm(n, mean = 3.1, sd = 0.2)
  
  # Fit the linear model and extract p-value from ANOVA
  model &lt;- lm(dental_caries ~ exposure)
  p_value &lt;- anova(model)$`Pr(&gt;F)`[1]
  
  # Store the results in the pre-allocated data frame
  results$PValue[i] &lt;- p_value
  results$Significant[i] &lt;- p_value &lt; 0.05
}

# View the results
print(results)</code></pre>
<pre><code>##    SampleSize     PValue Significant
## 1          10 0.98500956       FALSE
## 2          20 0.23605208       FALSE
## 3          30 0.36456770       FALSE
## 4          40 0.01690952        TRUE
## 5          50 0.04268098        TRUE
## 6          60 0.74157042       FALSE
## 7          70 0.63402811       FALSE
## 8          80 0.48056110       FALSE
## 9          90 0.41437733       FALSE
## 10        100 0.48753558       FALSE</code></pre>
<ol start="7" style="list-style-type: decimal">
<li><p>Alternatively, for the effect sizes you originally hypothesized,
what is the minimum sample size you would need in order to detect a
statistically significant effect? Again, run the model a few times with
the same parameter set to get a feeling for the effect of random
variation in the data.</p></li>
<li><p>Write up your results in a markdown file, organized with headers
and different code chunks to show your analysis. Be explicit in your
explanation and justification for sample sizes, means, and
variances.</p></li>
<li><p>If you have time, try repeating this exercise with one of the
more sophisticated distributions, such as the gamma or negative binomial
(depending on the kind of data you have). You will have to spend some
time figuring out by trial and error the parameter values you will need
to generate appropriate means and variances of the different
groups.</p></li>
</ol>
<p>edit</p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
